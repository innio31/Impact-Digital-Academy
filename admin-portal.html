<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Impact Digital Academy - Admin Portal</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --admin: #8e44ad;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Auth Pages */
        .auth-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, var(--admin), #6c3483);
        }

        .auth-box {
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 450px;
            padding: 30px;
        }

        .logo {
            text-align: center;
            margin-bottom: 20px;
        }

        .logo h1 {
            color: var(--admin);
            font-size: 24px;
            margin-bottom: 5px;
        }

        .logo p {
            color: var(--secondary);
            font-size: 14px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: border 0.3s;
        }

        .form-control:focus {
            border-color: var(--admin);
            outline: none;
        }

        .btn {
            display: inline-block;
            background: var(--admin);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: background 0.3s;
        }

        .btn:hover {
            background: #7d3c98;
        }

        .btn-primary {
            background: var(--admin);
        }

        .btn-secondary {
            background: var(--primary);
        }

        .btn-success {
            background: var(--success);
        }

        .btn-danger {
            background: var(--danger);
        }

        .btn-sm {
            padding: 8px 15px;
            font-size: 14px;
        }

        .auth-links {
            text-align: center;
            margin-top: 20px;
        }

        .auth-links a {
            color: var(--admin);
            text-decoration: none;
        }

        .auth-links a:hover {
            text-decoration: underline;
        }

        .hidden {
            display: none;
        }

        /* Dashboard */
        .dashboard {
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 250px;
            background: var(--admin);
            color: white;
            padding: 20px 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }

        .sidebar-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-menu li {
            margin-bottom: 5px;
        }

        .sidebar-menu a {
            display: block;
            color: white;
            text-decoration: none;
            padding: 12px 20px;
            transition: background 0.3s;
        }

        .sidebar-menu a:hover,
        .sidebar-menu a.active {
            background: rgba(255, 255, 255, 0.1);
        }

        .sidebar-menu i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        .main-content {
            flex: 1;
            margin-left: 250px;
            padding: 20px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
            margin-bottom: 20px;
        }

        .user-info {
            display: flex;
            align-items: center;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--admin);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
        }

        .admin-badge {
            background: var(--admin);
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 12px;
            margin-left: 10px;
        }

        .page-title {
            font-size: 24px;
            color: var(--admin);
            margin-bottom: 20px;
        }

        .card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            padding: 20px;
            margin-bottom: 20px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .card-title {
            font-size: 18px;
            color: var(--primary);
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            padding: 20px;
            text-align: center;
        }

        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: var(--admin);
            margin-bottom: 10px;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th,
        td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: var(--primary);
        }

        tr:hover {
            background: #f8f9fa;
        }

        .action-buttons {
            display: flex;
            gap: 5px;
        }

        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            border-radius: 8px;
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 20px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .modal-title {
            font-size: 20px;
            color: var(--primary);
        }

        .close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }

        .close:hover {
            color: var(--danger);
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid #eee;
            margin-bottom: 20px;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }

        .tab.active {
            border-bottom: 2px solid var(--admin);
            color: var(--admin);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .alert {
            padding: 12px 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }

        .alert-success {
            background: #e7f7ef;
            color: var(--success);
            border: 1px solid #d4f1e2;
        }

        .alert-error {
            background: #fbeeee;
            color: var(--danger);
            border: 1px solid #f8d7da;
        }

        .status-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-completed {
            background: #e7f7ef;
            color: var(--success);
        }

        .status-in-progress {
            background: #fef5e7;
            color: var(--warning);
        }

        .status-not-started {
            background: #fbeeee;
            color: var(--danger);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 70px;
            }

            .sidebar-header h2,
            .sidebar-menu span {
                display: none;
            }

            .sidebar-menu a {
                text-align: center;
                padding: 15px 10px;
            }

            .sidebar-menu i {
                margin-right: 0;
                font-size: 20px;
            }

            .main-content {
                margin-left: 70px;
            }
        }
    </style>
</head>

<body>
    <!-- Admin Login Page -->
    <div id="loginPage" class="auth-container">
        <div class="auth-box">
            <div class="logo">
                <h1>Impact Digital Academy</h1>
                <p>Admin Portal</p>
            </div>
            <div id="loginAlert" class="alert hidden"></div>
            <form id="loginForm">
                <div class="form-group">
                    <label for="loginEmail">Admin Email</label>
                    <input type="email" id="loginEmail" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" class="form-control" required>
                </div>
                <button type="submit" class="btn btn-primary">Login as Admin</button>
            </form>
            <div class="auth-links">
                <p><a href="#" id="showDebugInfo">Debug Info</a></p>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="dashboard" class="dashboard hidden">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>Impact Digital Academy</h2>
                <p>Admin Panel</p>
            </div>
            <ul class="sidebar-menu">
                <li><a href="#" class="active" data-page="dashboard"><i>üìä</i> <span>Dashboard</span></a></li>
                <li><a href="#" data-page="students"><i>üë®‚Äçüéì</i> <span>Manage Students</span></a></li>
                <li><a href="#" data-page="courses"><i>üìö</i> <span>Manage Courses</span></a></li>
                <li><a href="#" data-page="assignments"><i>üìù</i> <span>Assignments</span></a></li>
                <li><a href="#" data-page="grades"><i>üéì</i> <span>Grades & Assessments</span></a></li>
                <li><a href="#" data-page="notifications"><i>üì¢</i> <span>Send Notifications</span></a></li>
                <li><a href="#" data-page="support"><i>üí¨</i> <span>Support Tickets</span></a></li>
                <li><a href="#" data-page="reports"><i>üìà</i> <span>Reports & Analytics</span></a></li>
                <li><a href="#" id="logoutBtn"><i>üö™</i> <span>Logout</span></a></li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="header">
                <h1 id="pageTitle">Admin Dashboard</h1>
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">A</div>
                    <div>
                        <div id="userName">Admin User</div>
                        <span class="admin-badge">Administrator</span>
                    </div>
                </div>
            </div>

            <!-- Dashboard Content -->
            <div id="dashboardContent" class="page-content">
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-number" id="totalStudents">0</div>
                        <div class="stat-label">Total Students</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalCourses">0</div>
                        <div class="stat-label">Active Courses</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="pendingAssignments">0</div>
                        <div class="stat-label">Pending Assignments</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="supportTickets">0</div>
                        <div class="stat-label">Open Support Tickets</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Recent Student Activity</h2>
                        <button class="btn btn-primary btn-sm" id="viewAllStudents">View All</button>
                    </div>
                    <div class="table-container">
                        <table id="recentStudentsTable">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Program</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Recent students will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Recent Support Tickets</h2>
                        <button class="btn btn-primary btn-sm" id="viewAllTickets">View All</button>
                    </div>
                    <div class="table-container">
                        <table id="recentTicketsTable">
                            <thead>
                                <tr>
                                    <th>Student</th>
                                    <th>Subject</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Recent tickets will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Students Management Content -->
            <div id="studentsContent" class="page-content hidden">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Student Management</h2>
                        <button class="btn btn-primary" id="addStudentBtn">Add Student</button>
                    </div>
                    <div class="table-container">
                        <table id="studentsTable">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Program</th>
                                    <th>School</th>
                                    <th>Join Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Students will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Courses Management Content -->
            <div id="coursesContent" class="page-content hidden">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Course Management</h2>
                        <button class="btn btn-primary" id="addCourseBtn">Add Course</button>
                    </div>
                    <div class="table-container">
                        <table id="coursesTable">
                            <thead>
                                <tr>
                                    <th>Course Name</th>
                                    <th>Program Type</th>
                                    <th>Instructor</th>
                                    <th>Students Enrolled</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Courses will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Assignments Content -->
            <div id="assignmentsContent" class="page-content hidden">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Assignment Management</h2>
                        <button class="btn btn-primary" id="addAssignmentBtn">Create Assignment</button>
                    </div>
                    <div class="table-container">
                        <table id="assignmentsTable">
                            <thead>
                                <tr>
                                    <th>Title</th>
                                    <th>Course</th>
                                    <th>Due Date</th>
                                    <th>Submissions</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Assignments will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Grades Content -->
            <div id="gradesContent" class="page-content hidden">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Grade Management</h2>
                    </div>
                    <div class="tabs">
                        <div class="tab active" data-tab="studentGrades">Student Grades</div>
                        <div class="tab" data-tab="assessmentResults">Assessment Results</div>
                    </div>
                    <div class="tab-content active" id="studentGrades">
                        <div class="table-container">
                            <table id="gradesTable">
                                <thead>
                                    <tr>
                                        <th>Student</th>
                                        <th>Course</th>
                                        <th>Assignment</th>
                                        <th>Score</th>
                                        <th>Submitted</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Grades will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="tab-content" id="assessmentResults">
                        <div class="table-container">
                            <table id="assessmentsTable">
                                <thead>
                                    <tr>
                                        <th>Assessment</th>
                                        <th>Course</th>
                                        <th>Average Score</th>
                                        <th>Highest Score</th>
                                        <th>Lowest Score</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Assessments will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Notifications Content -->
            <div id="notificationsContent" class="page-content hidden">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Send Notifications</h2>
                    </div>
                    <form id="notificationForm">
                        <div class="form-group">
                            <label for="notificationTitle">Title</label>
                            <input type="text" id="notificationTitle" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="notificationMessage">Message</label>
                            <textarea id="notificationMessage" class="form-control" rows="5" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="notificationAudience">Audience</label>
                            <select id="notificationAudience" class="form-control" required>
                                <option value="all">All Students</option>
                                <option value="online">Online Program Students</option>
                                <option value="school">School Program Students</option>
                                <option value="onsite">Onsite Program Students</option>
                                <option value="specific">Specific Course</option>
                            </select>
                        </div>
                        <div class="form-group" id="specificCourseGroup" style="display: none;">
                            <label for="specificCourse">Select Course</label>
                            <select id="specificCourse" class="form-control">
                                <!-- Courses will be populated here -->
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">Send Notification</button>
                        </div>
                    </form>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Notification History</h2>
                    </div>
                    <div class="table-container">
                        <table id="notificationsTable">
                            <thead>
                                <tr>
                                    <th>Title</th>
                                    <th>Audience</th>
                                    <th>Date Sent</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Notifications will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Support Content -->
            <div id="supportContent" class="page-content hidden">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Support Tickets</h2>
                    </div>
                    <div class="table-container">
                        <table id="supportTicketsTable">
                            <thead>
                                <tr>
                                    <th>Student</th>
                                    <th>Subject</th>
                                    <th>Message</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Support tickets will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Reports Content -->
            <div id="reportsContent" class="page-content hidden">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Reports & Analytics</h2>
                    </div>
                    <div class="tabs">
                        <div class="tab active" data-tab="enrollmentReports">Enrollment Reports</div>
                        <div class="tab" data-tab="performanceReports">Performance Reports</div>
                        <div class="tab" data-tab="financialReports">Financial Reports</div>
                    </div>
                    <div class="tab-content active" id="enrollmentReports">
                        <div class="stats-container">
                            <div class="stat-card">
                                <div class="stat-number" id="onlineStudents">0</div>
                                <div class="stat-label">Online Students</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="schoolStudents">0</div>
                                <div class="stat-label">School Program Students</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="onsiteStudents">0</div>
                                <div class="stat-label">Onsite Students</div>
                            </div>
                        </div>
                        <div id="enrollmentChart"
                            style="height: 300px; background: #f8f9fa; display: flex; justify-content: center; align-items: center; margin-top: 20px;">
                            <p>Enrollment Chart Visualization</p>
                        </div>
                    </div>
                    <div class="tab-content" id="performanceReports">
                        <div class="table-container">
                            <table id="performanceTable">
                                <thead>
                                    <tr>
                                        <th>Course</th>
                                        <th>Average Grade</th>
                                        <th>Completion Rate</th>
                                        <th>Student Satisfaction</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Performance data will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="tab-content" id="financialReports">
                        <div class="stats-container">
                            <div class="stat-card">
                                <div class="stat-number">‚Ç¶2,450,000</div>
                                <div class="stat-label">Total Revenue</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">‚Ç¶1,850,000</div>
                                <div class="stat-label">Collected Fees</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">‚Ç¶600,000</div>
                                <div class="stat-label">Pending Payments</div>
                            </div>
                        </div>
                        <div id="revenueChart"
                            style="height: 300px; background: #f8f9fa; display: flex; justify-content: center; align-items: center; margin-top: 20px;">
                            <p>Revenue Chart Visualization</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Student Modal -->
    <div id="addStudentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add New Student</h3>
                <button class="close">&times;</button>
            </div>
            <form id="addStudentForm">
                <div class="form-group">
                    <label for="studentFullName">Full Name</label>
                    <input type="text" id="studentFullName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="studentEmail">Email</label>
                    <input type="email" id="studentEmail" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="studentProgramType">Program Type</label>
                    <select id="studentProgramType" class="form-control" required>
                        <option value="">Select Program Type</option>
                        <option value="online">Online Program</option>
                        <option value="school">School Program</option>
                        <option value="onsite">Impact Digital Academy (Onsite)</option>
                    </select>
                </div>
                <div class="form-group" id="studentSchoolGroup" style="display: none;">
                    <label for="studentSchool">School</label>
                    <select id="studentSchool" class="form-control">
                        <option value="">Select School</option>
                        <option value="school1">The Climax Brains Academy, Ota</option>
                        <option value="school2">Global Stars Academy</option>
                        <option value="school3">The Climax Model Schools, Ota</option>
                        <option value="school4">Mighty School For Valours</option>
                        <option value="school5">Latter Glory Schools</option>
                    </select>
                </div>
                <div class="form-group" id="studentProgramGroup" style="display: none;">
                    <label for="studentProgram">Program</label>
                    <select id="studentProgram" class="form-control">
                        <option value="">Select Program</option>
                        <option value="desktop-publishing">Desktop Publishing & Secretarial Studies</option>
                        <option value="digital-marketing">Digital Marketing</option>
                        <option value="web-development">Web Development</option>
                        <option value="pc-technician">PC Technician</option>
                        <option value="ui-ux">UI/UX</option>
                        <option value="data-science">Data Science</option>
                        <option value="graphic-design">Graphic Design</option>
                        <option value="cybersecurity-essentials">CyberSecurity Essentials</option>
                        <option value="android-app">Android App Development</option>
                        <option value="junior-cybersecurity">Junior CyberSecurity Analyst</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="studentPassword">Password</label>
                    <input type="password" id="studentPassword" class="form-control" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary close-modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Student</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Course Modal -->
    <div id="addCourseModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add New Course</h3>
                <button class="close">&times;</button>
            </div>
            <form id="addCourseForm">
                <div class="form-group">
                    <label for="courseName">Course Name</label>
                    <input type="text" id="courseName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="courseDescription">Description</label>
                    <textarea id="courseDescription" class="form-control" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label for="courseProgramType">Program Type</label>
                    <select id="courseProgramType" class="form-control" required>
                        <option value="online">Online Program</option>
                        <option value="onsite">Onsite Program</option>
                        <option value="both">Both Online & Onsite</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="courseInstructor">Instructor</label>
                    <input type="text" id="courseInstructor" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="courseDuration">Duration (weeks)</label>
                    <input type="number" id="courseDuration" class="form-control" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary close-modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Course</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Debug Modal -->
    <div id="debugModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Debug Information</h3>
                <button class="close">&times;</button>
            </div>
            <div id="debugContent">
                <!-- Debug info will be populated here -->
            </div>
        </div>
    </div>

    <script>
        // Firebase configuration - MAKE SURE THIS MATCHES YOUR INIT CONFIG
        const firebaseConfig = {
            apiKey: "AIzaSyDU1ouyoXpOP0Gz_IFARGGAK0OAu0GZHlI",
            authDomain: "digskills-student-portal.firebaseapp.com",
            projectId: "digskills-student-portal",
            storageBucket: "digskills-student-portal.firebasestorage.app",
            messagingSenderId: "992494289117",
            appId: "1:992494289117:web:de1c682fb12ae9fae69b34",
            measurementId: "G-PKF5FPQN38"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // DOM Elements
        const loginPage = document.getElementById('loginPage');
        const dashboard = document.getElementById('dashboard');
        const loginForm = document.getElementById('loginForm');
        const loginAlert = document.getElementById('loginAlert');
        const showDebugInfo = document.getElementById('showDebugInfo');
        const debugModal = document.getElementById('debugModal');
        const debugContent = document.getElementById('debugContent');
        const logoutBtn = document.getElementById('logoutBtn');

        // Navigation Elements
        const pageContents = document.querySelectorAll('.page-content');
        const sidebarLinks = document.querySelectorAll('.sidebar-menu a[data-page]');

        // Student Management Elements
        const addStudentBtn = document.getElementById('addStudentBtn');
        const addStudentModal = document.getElementById('addStudentModal');
        const addStudentForm = document.getElementById('addStudentForm');
        const studentProgramType = document.getElementById('studentProgramType');
        const studentSchoolGroup = document.getElementById('studentSchoolGroup');
        const studentProgramGroup = document.getElementById('studentProgramGroup');

        // Course Management Elements
        const addCourseBtn = document.getElementById('addCourseBtn');
        const addCourseModal = document.getElementById('addCourseModal');
        const addCourseForm = document.getElementById('addCourseForm');

        // Notification Elements
        const notificationForm = document.getElementById('notificationForm');
        const notificationAudience = document.getElementById('notificationAudience');
        const specificCourseGroup = document.getElementById('specificCourseGroup');

        // Tab Elements
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');

        // Modal Close Buttons
        const closeButtons = document.querySelectorAll('.close, .close-modal');

        // Show Debug Info
        showDebugInfo.addEventListener('click', function (e) {
            e.preventDefault();
            showDebugInformation();
        });

        // Close modal when clicking X
        document.querySelectorAll('.close').forEach(closeBtn => {
            closeBtn.addEventListener('click', function () {
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.style.display = 'none';
                });
            });
        });

        // Close modal when clicking outside
        window.addEventListener('click', function (e) {
            if (e.target.classList.contains('modal')) {
                e.target.style.display = 'none';
            }
        });

        // Close modal with close-modal buttons
        document.querySelectorAll('.close-modal').forEach(btn => {
            btn.addEventListener('click', function () {
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.style.display = 'none';
                });
            });
        });

        // Login form submission - FIXED VERSION
        loginForm.addEventListener('submit', function (e) {
            e.preventDefault();

            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            loginAlert.classList.remove('hidden');
            loginAlert.textContent = 'Logging in...';
            loginAlert.className = 'alert alert-info';

            // Step 1: Authenticate with Firebase Auth
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    const user = userCredential.user;
                    console.log('Firebase Auth successful for user:', user.uid);

                    // Step 2: Check user role in Firestore
                    return db.collection('users').doc(user.uid).get();
                })
                .then((doc) => {
                    if (!doc.exists) {
                        throw new Error('User document not found in Firestore');
                    }

                    const userData = doc.data();
                    console.log('Firestore user data:', userData);

                    if (userData.role === 'admin') {
                        // SUCCESS: User is an admin
                        loginAlert.textContent = 'Admin login successful!';
                        loginAlert.className = 'alert alert-success';

                        // Update last login
                        return db.collection('users').doc(doc.id).update({
                            lastLogin: firebase.firestore.FieldValue.serverTimestamp()
                        }).then(() => {
                            // Redirect to dashboard
                            setTimeout(() => {
                                loginPage.classList.add('hidden');
                                dashboard.classList.remove('hidden');
                                loadAdminData();
                            }, 1000);
                        });
                    } else {
                        // User is not an admin
                        auth.signOut(); // Sign out non-admin users
                        throw new Error('User does not have admin privileges. Role: ' + (userData.role || 'undefined'));
                    }
                })
                .catch((error) => {
                    console.error('Login error:', error);
                    loginAlert.textContent = 'Login failed: ' + error.message;
                    loginAlert.className = 'alert alert-error';

                    // Show detailed error for debugging
                    if (error.code === 'auth/user-not-found') {
                        loginAlert.textContent += ' (User not found in authentication)';
                    } else if (error.code === 'auth/wrong-password') {
                        loginAlert.textContent += ' (Incorrect password)';
                    } else if (error.message.includes('admin privileges')) {
                        loginAlert.textContent += ' - Please contact system administrator';
                    }
                });
        });

        // Logout
        logoutBtn.addEventListener('click', function (e) {
            e.preventDefault();
            auth.signOut();
        });

        // Dashboard navigation
        sidebarLinks.forEach(link => {
            link.addEventListener('click', function (e) {
                e.preventDefault();

                // Remove active class from all links
                sidebarLinks.forEach(l => l.classList.remove('active'));
                // Add active class to clicked link
                this.classList.add('active');

                // Hide all page contents
                pageContents.forEach(content => content.classList.add('hidden'));

                // Show selected page content
                const pageId = this.getAttribute('data-page') + 'Content';
                document.getElementById(pageId).classList.remove('hidden');

                // Update page title
                document.getElementById('pageTitle').textContent = this.querySelector('span').textContent;
            });
        });

        // Tab navigation
        tabs.forEach(tab => {
            tab.addEventListener('click', function () {
                const tabId = this.getAttribute('data-tab');

                // Remove active class from all tabs and tab contents
                tabs.forEach(t => t.classList.remove('active'));
                tabContents.forEach(tc => tc.classList.remove('active'));

                // Add active class to clicked tab and corresponding content
                this.classList.add('active');
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Show/Hide sections based on program type in add student form
        studentProgramType.addEventListener('change', function () {
            const selectedType = this.value;

            // Reset
            studentSchoolGroup.style.display = 'none';
            studentProgramGroup.style.display = 'none';

            if (selectedType === 'school') {
                studentSchoolGroup.style.display = 'block';
            } else if (selectedType === 'online' || selectedType === 'onsite') {
                studentProgramGroup.style.display = 'block';
            }
        });

        // Show/Hide specific course selection based on notification audience
        notificationAudience.addEventListener('change', function () {
            if (this.value === 'specific') {
                specificCourseGroup.style.display = 'block';
            } else {
                specificCourseGroup.style.display = 'none';
            }
        });

        // Modal controls
        addStudentBtn.addEventListener('click', function () {
            addStudentModal.style.display = 'flex';
        });

        addCourseBtn.addEventListener('click', function () {
            addCourseModal.style.display = 'flex';
        });

        // Add Student Form Submission
        addStudentForm.addEventListener('submit', function (e) {
            e.preventDefault();

            const fullName = document.getElementById('studentFullName').value;
            const email = document.getElementById('studentEmail').value;
            const password = document.getElementById('studentPassword').value;
            const programType = document.getElementById('studentProgramType').value;

            let school = '';
            let program = '';

            if (programType === 'school') {
                school = document.getElementById('studentSchool').value;
                program = 'School Program';
            } else {
                program = document.getElementById('studentProgram').value;
                school = 'Impact Digital Academy';
            }

            // Create student account
            auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    const user = userCredential.user;

                    // Save student data to Firestore
                    return db.collection('users').doc(user.uid).set({
                        fullName: fullName,
                        email: email,
                        programType: programType,
                        school: school,
                        program: program,
                        role: 'student',
                        status: 'active',
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                })
                .then(() => {
                    alert('Student account created successfully!');
                    addStudentModal.style.display = 'none';
                    addStudentForm.reset();
                    loadStudentsData(); // Refresh students table
                    loadDashboardStats(); // Refresh dashboard stats
                })
                .catch((error) => {
                    alert('Error creating student account: ' + error.message);
                });
        });

        // Add Course Form Submission
        addCourseForm.addEventListener('submit', function (e) {
            e.preventDefault();

            const name = document.getElementById('courseName').value;
            const description = document.getElementById('courseDescription').value;
            const programType = document.getElementById('courseProgramType').value;
            const instructor = document.getElementById('courseInstructor').value;
            const duration = document.getElementById('courseDuration').value;

            db.collection('courses').add({
                name: name,
                description: description,
                programType: programType,
                instructor: instructor,
                duration: duration,
                status: 'active',
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            })
                .then(() => {
                    alert('Course created successfully!');
                    addCourseModal.style.display = 'none';
                    addCourseForm.reset();
                    loadCoursesData(); // Refresh courses table
                    loadDashboardStats(); // Refresh dashboard stats
                })
                .catch((error) => {
                    alert('Error creating course: ' + error.message);
                });
        });

        // Notification Form Submission
        notificationForm.addEventListener('submit', function (e) {
            e.preventDefault();

            const title = document.getElementById('notificationTitle').value;
            const message = document.getElementById('notificationMessage').value;
            const audience = document.getElementById('notificationAudience').value;
            const specificCourse = document.getElementById('specificCourse').value;

            db.collection('notifications').add({
                title: title,
                message: message,
                audience: audience,
                specificCourse: specificCourse,
                sentBy: auth.currentUser.uid,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            })
                .then(() => {
                    alert('Notification sent successfully!');
                    notificationForm.reset();
                    loadNotificationsData(); // Refresh notifications table
                })
                .catch((error) => {
                    alert('Error sending notification: ' + error.message);
                });
        });

        // Load admin data and dashboard
        function loadAdminData() {
            const user = auth.currentUser;

            if (user) {
                // Get user data from Firestore
                db.collection('users').doc(user.uid).get()
                    .then((doc) => {
                        if (doc.exists) {
                            const userData = doc.data();

                            // Update UI with user data
                            document.getElementById('userName').textContent = userData.fullName || 'Admin User';

                            // Set user avatar initials
                            const nameParts = (userData.fullName || 'Admin').split(' ');
                            const initials = nameParts[0].charAt(0) + (nameParts[1] ? nameParts[1].charAt(0) : '');
                            document.getElementById('userAvatar').textContent = initials;

                            // Load all dashboard data
                            loadDashboardStats();
                            loadStudentsData();
                            loadCoursesData();
                            loadSupportTickets();
                            loadNotificationsData();
                        }
                    })
                    .catch((error) => {
                        console.error('Error loading admin data:', error);
                    });
            }
        }

        // Load dashboard statistics
        function loadDashboardStats() {
            // Total students
            db.collection('users').where('role', '==', 'student').get()
                .then((querySnapshot) => {
                    document.getElementById('totalStudents').textContent = querySnapshot.size;

                    // Count students by program type
                    let onlineCount = 0;
                    let schoolCount = 0;
                    let onsiteCount = 0;

                    querySnapshot.forEach((doc) => {
                        const data = doc.data();
                        if (data.programType === 'online') onlineCount++;
                        else if (data.programType === 'school') schoolCount++;
                        else if (data.programType === 'onsite') onsiteCount++;
                    });

                    document.getElementById('onlineStudents').textContent = onlineCount;
                    document.getElementById('schoolStudents').textContent = schoolCount;
                    document.getElementById('onsiteStudents').textContent = onsiteCount;
                })
                .catch((error) => {
                    console.error('Error loading students count:', error);
                    document.getElementById('totalStudents').textContent = '0';
                });

            // Total courses
            db.collection('courses').where('status', '==', 'active').get()
                .then((querySnapshot) => {
                    document.getElementById('totalCourses').textContent = querySnapshot.size;
                })
                .catch((error) => {
                    console.error('Error loading courses count:', error);
                    document.getElementById('totalCourses').textContent = '0';
                });

            // Support tickets
            db.collection('supportMessages').where('status', '==', 'open').get()
                .then((querySnapshot) => {
                    document.getElementById('supportTickets').textContent = querySnapshot.size;
                })
                .catch((error) => {
                    console.error('Error loading support tickets:', error);
                    document.getElementById('supportTickets').textContent = '0';
                });

            // Mock data for pending assignments
            document.getElementById('pendingAssignments').textContent = '24';
        }

        // Load students data
        function loadStudentsData() {
            const studentsTable = document.getElementById('studentsTable');
            const recentStudentsTable = document.getElementById('recentStudentsTable');

            // Clear existing rows
            studentsTable.querySelector('tbody').innerHTML = '';
            recentStudentsTable.querySelector('tbody').innerHTML = '';

            db.collection('users').where('role', '==', 'student').orderBy('createdAt', 'desc').get()
                .then((querySnapshot) => {
                    let count = 0;
                    querySnapshot.forEach((doc) => {
                        const data = doc.data();
                        const studentId = doc.id;

                        const row = `
                            <tr>
                                <td>${data.fullName}</td>
                                <td>${data.email}</td>
                                <td>${data.program}</td>
                                <td>${data.school}</td>
                                <td>${data.createdAt ? data.createdAt.toDate().toLocaleDateString() : 'N/A'}</td>
                                <td><span class="status-badge status-completed">${data.status || 'active'}</span></td>
                                <td class="action-buttons">
                                    <button class="btn btn-primary btn-sm" onclick="viewStudent('${studentId}')">View</button>
                                    <button class="btn btn-secondary btn-sm" onclick="editStudent('${studentId}')">Edit</button>
                                    <button class="btn btn-danger btn-sm" onclick="deleteStudent('${studentId}')">Delete</button>
                                </td>
                            </tr>
                        `;

                        studentsTable.querySelector('tbody').innerHTML += row;

                        // Add to recent students table (first 5 only)
                        if (count < 5) {
                            recentStudentsTable.querySelector('tbody').innerHTML += `
                                <tr>
                                    <td>${data.fullName}</td>
                                    <td>${data.email}</td>
                                    <td>${data.program}</td>
                                    <td><span class="status-badge status-completed">${data.status || 'active'}</span></td>
                                    <td class="action-buttons">
                                        <button class="btn btn-primary btn-sm" onclick="viewStudent('${studentId}')">View</button>
                                    </td>
                                </tr>
                            `;
                            count++;
                        }
                    });
                })
                .catch((error) => {
                    console.error('Error loading students:', error);
                });
        }

        // Load courses data
        function loadCoursesData() {
            const coursesTable = document.getElementById('coursesTable');

            // Clear existing rows
            coursesTable.querySelector('tbody').innerHTML = '';

            db.collection('courses').orderBy('createdAt', 'desc').get()
                .then((querySnapshot) => {
                    querySnapshot.forEach((doc) => {
                        const data = doc.data();
                        const courseId = doc.id;

                        // Mock enrolled students count
                        const enrolledStudents = Math.floor(Math.random() * 50) + 10;

                        const row = `
                            <tr>
                                <td>${data.name}</td>
                                <td>${data.programType}</td>
                                <td>${data.instructor}</td>
                                <td>${enrolledStudents}</td>
                                <td><span class="status-badge status-completed">${data.status}</span></td>
                                <td class="action-buttons">
                                    <button class="btn btn-primary btn-sm" onclick="viewCourse('${courseId}')">View</button>
                                    <button class="btn btn-secondary btn-sm" onclick="editCourse('${courseId}')">Edit</button>
                                    <button class="btn btn-danger btn-sm" onclick="deleteCourse('${courseId}')">Delete</button>
                                </td>
                            </tr>
                        `;

                        coursesTable.querySelector('tbody').innerHTML += row;
                    });
                })
                .catch((error) => {
                    console.error('Error loading courses:', error);
                });
        }

        // Load support tickets
        function loadSupportTickets() {
            const supportTicketsTable = document.getElementById('supportTicketsTable');
            const recentTicketsTable = document.getElementById('recentTicketsTable');

            // Clear existing rows
            supportTicketsTable.querySelector('tbody').innerHTML = '';
            recentTicketsTable.querySelector('tbody').innerHTML = '';

            db.collection('supportMessages').orderBy('createdAt', 'desc').get()
                .then((querySnapshot) => {
                    let count = 0;
                    querySnapshot.forEach((doc) => {
                        const data = doc.data();
                        const ticketId = doc.id;

                        // Get student name (in a real app, you'd fetch this from the users collection)
                        const studentName = data.userId ? `Student ${data.userId.substring(0, 8)}` : 'Unknown Student';

                        const row = `
                            <tr>
                                <td>${studentName}</td>
                                <td>${data.subject}</td>
                                <td>${data.message.substring(0, 50)}...</td>
                                <td>${data.createdAt ? data.createdAt.toDate().toLocaleDateString() : 'N/A'}</td>
                                <td><span class="status-badge ${data.status === 'open' ? 'status-in-progress' : 'status-completed'}">${data.status}</span></td>
                                <td class="action-buttons">
                                    <button class="btn btn-primary btn-sm" onclick="viewTicket('${ticketId}')">View</button>
                                    <button class="btn btn-success btn-sm" onclick="resolveTicket('${ticketId}')">Resolve</button>
                                </td>
                            </tr>
                        `;

                        supportTicketsTable.querySelector('tbody').innerHTML += row;

                        // Add to recent tickets table (first 5 only)
                        if (count < 5) {
                            recentTicketsTable.querySelector('tbody').innerHTML += `
                                <tr>
                                    <td>${studentName}</td>
                                    <td>${data.subject}</td>
                                    <td>${data.createdAt ? data.createdAt.toDate().toLocaleDateString() : 'N/A'}</td>
                                    <td><span class="status-badge ${data.status === 'open' ? 'status-in-progress' : 'status-completed'}">${data.status}</span></td>
                                    <td class="action-buttons">
                                        <button class="btn btn-primary btn-sm" onclick="viewTicket('${ticketId}')">View</button>
                                    </td>
                                </tr>
                            `;
                            count++;
                        }
                    });
                })
                .catch((error) => {
                    console.error('Error loading support tickets:', error);
                });
        }

        // Load notifications data
        function loadNotificationsData() {
            const notificationsTable = document.getElementById('notificationsTable');

            // Clear existing rows
            notificationsTable.querySelector('tbody').innerHTML = '';

            db.collection('notifications').orderBy('createdAt', 'desc').limit(10).get()
                .then((querySnapshot) => {
                    querySnapshot.forEach((doc) => {
                        const data = doc.data();

                        const row = `
                            <tr>
                                <td>${data.title}</td>
                                <td>${data.audience}</td>
                                <td>${data.createdAt ? data.createdAt.toDate().toLocaleDateString() : 'N/A'}</td>
                                <td><span class="status-badge status-completed">Sent</span></td>
                            </tr>
                        `;

                        notificationsTable.querySelector('tbody').innerHTML += row;
                    });
                })
                .catch((error) => {
                    console.error('Error loading notifications:', error);
                });
        }

        // Debug function to show current state
        function showDebugInformation() {
            let debugHTML = '<h4>Current Firebase Configuration:</h4>';
            debugHTML += `<pre>${JSON.stringify(firebaseConfig, null, 2)}</pre>`;

            debugHTML += '<h4>Authentication State:</h4>';
            const user = auth.currentUser;
            if (user) {
                debugHTML += `<p>‚úÖ User Authenticated: ${user.email} (UID: ${user.uid})</p>`;

                // Check Firestore user document
                db.collection('users').doc(user.uid).get()
                    .then((doc) => {
                        if (doc.exists) {
                            debugHTML += `<h4>Firestore User Document:</h4>`;
                            debugHTML += `<pre>${JSON.stringify(doc.data(), null, 2)}</pre>`;
                            debugHTML += `<p>Role: <strong>${doc.data().role}</strong></p>`;
                        } else {
                            debugHTML += `<p>‚ùå No user document found in Firestore for UID: ${user.uid}</p>`;
                        }
                        debugContent.innerHTML = debugHTML;
                        debugModal.style.display = 'flex';
                    })
                    .catch((error) => {
                        debugHTML += `<p>‚ùå Error fetching user document: ${error.message}</p>`;
                        debugContent.innerHTML = debugHTML;
                        debugModal.style.display = 'flex';
                    });
            } else {
                debugHTML += '<p>‚ùå No user authenticated</p>';
                debugContent.innerHTML = debugHTML;
                debugModal.style.display = 'flex';
            }
        }

        // Check auth state on page load
        auth.onAuthStateChanged((user) => {
            console.log('Auth state changed:', user);

            if (user) {
                // User is signed in, check if admin
                db.collection('users').doc(user.uid).get()
                    .then((doc) => {
                        if (doc.exists && doc.data().role === 'admin') {
                            // User is admin, show dashboard
                            loginPage.classList.add('hidden');
                            dashboard.classList.remove('hidden');
                            loadAdminData();
                        } else {
                            // User is not admin, sign out and show login
                            auth.signOut();
                            loginPage.classList.remove('hidden');
                            dashboard.classList.add('hidden');
                            loginAlert.textContent = 'Access denied. Admin privileges required.';
                            loginAlert.className = 'alert alert-error';
                            loginAlert.classList.remove('hidden');
                        }
                    })
                    .catch((error) => {
                        console.error('Error checking user role:', error);
                        auth.signOut();
                        loginPage.classList.remove('hidden');
                    });
            } else {
                // User is signed out
                loginPage.classList.remove('hidden');
                dashboard.classList.add('hidden');
            }
        });

        // Student management functions
        function viewStudent(studentId) {
            alert(`View student details for ID: ${studentId}`);
        }

        function editStudent(studentId) {
            alert(`Edit student with ID: ${studentId}`);
        }

        function deleteStudent(studentId) {
            if (confirm('Are you sure you want to delete this student?')) {
                // Delete student from Firestore and Auth
                db.collection('users').doc(studentId).delete()
                    .then(() => {
                        // Also delete the auth user (you would need the user's UID)
                        alert('Student deleted successfully!');
                        loadStudentsData();
                        loadDashboardStats();
                    })
                    .catch((error) => {
                        alert('Error deleting student: ' + error.message);
                    });
            }
        }

        // Course management functions
        function viewCourse(courseId) {
            alert(`View course details for ID: ${courseId}`);
        }

        function editCourse(courseId) {
            alert(`Edit course with ID: ${courseId}`);
        }

        function deleteCourse(courseId) {
            if (confirm('Are you sure you want to delete this course?')) {
                db.collection('courses').doc(courseId).delete()
                    .then(() => {
                        alert('Course deleted successfully!');
                        loadCoursesData();
                        loadDashboardStats();
                    })
                    .catch((error) => {
                        alert('Error deleting course: ' + error.message);
                    });
            }
        }

        // Support ticket functions
        function viewTicket(ticketId) {
            alert(`View ticket details for ID: ${ticketId}`);
        }

        function resolveTicket(ticketId) {
            db.collection('supportMessages').doc(ticketId).update({
                status: 'resolved'
            })
                .then(() => {
                    alert('Ticket marked as resolved!');
                    loadSupportTickets();
                    loadDashboardStats();
                })
                .catch((error) => {
                    alert('Error resolving ticket: ' + error.message);
                });
        }

        // Auto-fill credentials from localStorage (for testing)
        window.addEventListener('load', function () {
            const savedEmail = localStorage.getItem('adminEmail');
            const savedPassword = localStorage.getItem('adminPassword');

            if (savedEmail && savedPassword) {
                document.getElementById('loginEmail').value = savedEmail;
                document.getElementById('loginPassword').value = savedPassword;
            }

            console.log('Admin portal loaded');
        });
    </script>
</body>

</html>